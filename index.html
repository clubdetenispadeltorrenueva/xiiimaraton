<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sorteo Torneo de Tenis</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
      margin: 0;
      padding: 2rem;
    }
    h1, h2 {
      text-align: center;
      margin-bottom: 1rem;
    }
    .timer {
      text-align: center;
      font-size: 1.5rem;
      color: #d9534f;
      margin-bottom: 2rem;
    }
    .cuadro {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      max-width: 700px;
      margin: 0 auto 3rem;
    }
    .match {
      background: white;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <h1>Sorteo Torneo de Tenis</h1>
  <div class="timer" id="temporizador">Cargando temporizador...</div>

  <div id="contenido" style="display: none">
    <h2>Cuadro Principal</h2>
    <div class="cuadro" id="cuadroPrincipal"></div>

    <h2>Cuadro de Consolaci칩n</h2>
    <div class="cuadro" id="cuadroConsolacion"></div>
  </div>

  <script>
    const jugadores = [
      "Valent칤n Juan", "Carlos Gonz치lez", "Antonio Gonz치lez", "Salvador Vivar",
      "El칤as Gonz치lez", "Rub칠n Arce", "H칠ctor Arce", "Carlos Pi침a",
      "J. Eduardo Toledo", "Juan Carlos Garcia", "Carmelo Toledo", "Antonio Ca침averas",
      "Jesus Perea", "David Le칩n", "Ram칩n Campos", "Carlos Sim칩n",
      "Ram칩n Solera", "Alberto J. Beltr치n", "V칤ctor Mata", "Jes칰s Ruiz"
    ];

    const cabezas = {
      0: "Valent칤n Juan",
      15: "Juan Carlos Garcia",
      16: "El칤as Gonz치lez",
      31: "David Le칩n"
    };

    function crearCuadro() {
      const cuadro = Array(32).fill(null);
      for (const [pos, nombre] of Object.entries(cabezas)) {
        cuadro[parseInt(pos)] = nombre;
      }

      const restantes = jugadores.filter(j => !Object.values(cabezas).includes(j));
      const BYEs = 32 - jugadores.length;
      for (let i = 0; i < BYEs; i++) restantes.push("BYE");

      shuffle(restantes);
      let idx = 0;
      for (let i = 0; i < 32; i++) {
        if (cuadro[i] === null) {
          cuadro[i] = restantes[idx++];
        }
      }

      return cuadro;
    }

    function shuffle(arr) {
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
    }

    function mostrarCuadro(cuadro) {
      const divPrincipal = document.getElementById("cuadroPrincipal");
      const divConsolacion = document.getElementById("cuadroConsolacion");
      divPrincipal.innerHTML = "";
      divConsolacion.innerHTML = "";

      const perdedores = [];

      for (let i = 0; i < 32; i += 2) {
        const j1 = cuadro[i];
        const j2 = cuadro[i + 1];
        divPrincipal.innerHTML += `<div class="match">Partido ${(i/2)+1}: ${j1} vs ${j2}</div>`;
        if (j1 !== "BYE" && j2 !== "BYE") {
          perdedores.push(`Perdedor de Partido ${(i/2)+1}`);
        }
      }

      shuffle(perdedores);

      for (let i = 0; i < perdedores.length; i += 2) {
        const c1 = perdedores[i] || "-";
        const c2 = perdedores[i + 1] || "-";
        divConsolacion.innerHTML += `<div class="match">${c1} vs ${c2}</div>`;
      }
    }

    function iniciarTemporizador(horaObjetivo) {
      const temporizador = document.getElementById("temporizador");
      const contenido = document.getElementById("contenido");

      const intervalo = setInterval(() => {
        const ahora = new Date();
        const diferencia = horaObjetivo - ahora;

        if (diferencia <= 0) {
          clearInterval(intervalo);
          temporizador.innerText = "游 Sorteo realizado";
          contenido.style.display = "block";
          const cuadro = crearCuadro();
          mostrarCuadro(cuadro);
        } else {
          const minutos = Math.floor(diferencia / 60000);
          const segundos = Math.floor((diferencia % 60000) / 1000);
          temporizador.innerText = `Sorteo en: ${minutos}m ${segundos}s`;
        }
      }, 1000);
    }

    // Hora fija: hoy a las 9:30 hora local
    const ahora = new Date();
    const hoy930 = new Date(ahora.getFullYear(), ahora.getMonth(), ahora.getDate(), 9, 30, 0);
    if (ahora > hoy930) hoy930.setDate(hoy930.getDate() + 1); // Si ya pas칩, ser치 ma침ana

    iniciarTemporizador(hoy930);
  </script>
</body>
</html>
